{% extends "base.html" %}

{% block content %}
<h2>Registro de Restaurante</h2>
<form id="restaurant-form" method="post" action="{{ url_for('restaurant_setup') }}" enctype="multipart/form-data">
    <label for="nombre">Nombre del restaurante</label>
    <input type="text" id="nombre" name="nombre" required>

    <label for="direccion">Dirección</label>
    <input type="text" id="direccion" name="direccion">

    <label for="telefono">Teléfono</label>
    <input type="text" id="telefono" name="telefono">

    <label for="foto">Logo/Foto del restaurante (opcional)</label>
    <input type="file" id="foto" name="foto" accept="image/*">

    <h3>Menú</h3>
    <table id="menu-table">
        <thead><tr><th>Nombre</th><th>Precio</th><th>Cantidad</th><th></th></tr></thead>
        <tbody></tbody>
    </table>
    <p><button type="button" id="add-item">Agregar item</button></p>

    <button type="submit">Crear restaurante y menú</button>
</form>

<script>
(function(){
    const tableBody = document.querySelector('#menu-table tbody');
    const addBtn = document.getElementById('add-item');

    function addRow(data){
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td><input name="item_nombre" type="text" value="${data && data.nombre ? data.nombre : ''}" required></td>
            <td><input name="item_precio" type="number" step="0.01" value="${data && data.precio ? data.precio : ''}" required></td>
            <td><input name="item_cantidad" type="number" value="${data && data.cantidad ? data.cantidad : 0}" min="0"></td>
            <td><button type="button" class="remove">Eliminar</button></td>
        `;
        tr.querySelector('.remove').addEventListener('click', ()=> tr.remove());
        tableBody.appendChild(tr);
    }

    addBtn.addEventListener('click', ()=> addRow());
    // add one empty row initially
    addRow();

    // On submit, we will serialize the form and post normally to the server endpoint which
    // will forward to restaurantes service to create restaurant and items.
})();
</script>

{% endblock %}
